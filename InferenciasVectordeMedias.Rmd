---
title: "inferencias Vector de medias"
author: "Roberto Duarte"
date: "2025-10-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Inferencias sobre el vector de medias
#### Ejemplo 1

```{r, echo=F}
data<-data.frame(x=c(6,10,8),
                 y=c(9,6,3))
n<-3
p<-2
alpha<-0.05
mu0<-c(9,5)

```

Queremos contrastar las hipótesis:

$H_0:\boldsymbol{\mu}=(9,5)^t$ vs $H_1:\boldsymbol{\mu}\neq(9,5)^t$

Calculamos el vector de medias y la matriz de varianza y covarianza

```{r}
xbar<- colMeans(data)
xbar
S<- cov(data)
S
```
Calculamos la estadística de prueba $T^2$

```{r}
T2<-n*t(xbar-mu0)%*%solve(S)%*%(xbar-mu0)
T2
```

La estadística de prueba es `r T2`, ahora necesitamos calcular el percentil de la distribucioón T de Hotelling

```{r}
Tc<-(n-1)*p/(n-p)*qf(alpha,p,n-p, lower.tail = F)
Tc
```

El valor crítico de la distribución es `r Tc`, notemos que 7/9 < 798 por lo tanto no podemos rechazar la hipótesis nula.


## Elipse de confianza
```{r}
#install.packages(ellipse)
plot(ellipse::ellipse(S, centre=xbar,t=sqrt(Tc/n)),type="l")
points(x=9, y=5)

```

### Ejemplo horno microondas

El departamento de control de calidad de un fabricante de hornos microondas está obligado por el gobierno federal a monitorear la cantidad de radiación emitida cuando las puertas de los hornos están cerradas.

Con este propósito, se realizaron observaciones de la radiación emitida a través de las puertas cerradas de n = 42 hornos seleccionados aleatoriamente.
Posteriormente, también se registraron mediciones de radiación a través de las puertas abiertas de los mismos 42 hornos.

Se ha establecido niveles de radiación de 0.60 y 0.55 para puerta abierta y cerrada respectivamente, a partir de estos datos, se puede concluir que los microondas cumplen con los límites de radiación establecidos, a un nivel de significacancia de 0.05.



```{r}
radiation_data <- data.frame(
  oven = 1:42,
  door_open = c(
    0.30, 0.09, 0.30, 0.10, 0.10, 0.12, 0.09, 0.10, 0.09, 0.10,
    0.07, 0.05, 0.01, 0.45, 0.12, 0.20, 0.04, 0.10, 0.01, 0.60,
    0.12, 0.10, 0.05, 0.05, 0.15, 0.30, 0.15, 0.09, 0.09, 0.28,
    0.10, 0.10, 0.10, 0.30, 0.12, 0.25, 0.20, 0.40, 0.33, 0.32,
    0.12, 0.12
  ),
  door_closed = c(
    0.15, 0.09, 0.18, 0.10, 0.05, 0.12, 0.08, 0.05, 0.08, 0.10,
    0.07, 0.02, 0.01, 0.10, 0.10, 0.10, 0.02, 0.10, 0.01, 0.40,
    0.10, 0.05, 0.03, 0.05, 0.15, 0.10, 0.15, 0.09, 0.08, 0.18,
    0.10, 0.20, 0.11, 0.30, 0.02, 0.20, 0.20, 0.30, 0.30, 0.40,
    0.30, 0.05
  )
)


radiation_data$door_open_trans<-radiation_data$door_open^(1/4)
radiation_data$door_closed_trans<-radiation_data$door_closed^(1/4)
```

Queremos contrastar las hipótesis: $H_0:\boldsymbol{\mu}=(0.6,0.55)^t$ vs $H_1:\boldsymbol{\mu}\neq (0.6,0.55)^t$


```{r}
n<-42
p<-2
xbar<-colMeans(radiation_data[,4:5])
mu0<-c(0.6,0.55)
S<- cov(radiation_data[,4:5])
xbar
S
```
Calculamos la estadística de prueba

```{r}
T2p<-n*t(xbar-mu0)%*%solve(S)%*%(xbar-mu0)
T2p
```

Calculamos el valor crítico
```{r}
T2c<- (n-1)*p/(n-p)*qf(0.05, p,n-p, lower.tail = F)
T2c
```

Conclusión: No rechazamos la hipótesis nula, por lo tanto, los niveles de radiación estan bien



```{r}
plot(ellipse::ellipse(S, centre=xbar,t=sqrt(T2c/n)),type="l")
points(x=0.6,y=0.55, pch=19, col="firebrick")
```



